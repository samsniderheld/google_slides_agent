<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Slides Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tailwind-v4.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .concept-textarea {
            min-height: 200px;
            resize: vertical;
        }
        .tool-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }
        .tool-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }
        .icon-circle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            color: white;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center mb-4">
                <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center mr-3">
                    <span class="text-white font-bold text-sm">SG</span>
                </div>
                <h1 class="text-2xl font-semibold text-gray-900">
                    Google Slides Generator
                </h1>
            </div>
            <p class="text-gray-600">
                Generate creative presentations from your concepts using AI
            </p>
        </div>

        <!-- Grid Layout -->
        <div class="grid md:grid-cols-3 gap-6">
            <!-- Left Side - Main Tool -->
            <div class="md:col-span-2">
                <div class="tool-card p-6">
                    <div class="flex items-center mb-6">
                        <div class="icon-circle bg-gradient-to-r from-purple-500 to-blue-500 mr-4">
                            <i class="fas fa-rocket text-lg"></i>
                        </div>
                        <div>
                            <h2 class="text-xl font-semibold text-gray-900">Presentation Generator</h2>
                            <p class="text-gray-600 text-sm">Create beautiful slide decks from your concepts</p>
                        </div>
                    </div>

                    <!-- Authentication Status -->
                    {% if user_info %}
                        <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4 flex items-center">
                            <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-green-800 text-sm font-medium">
                                    Authenticated as {{ user_info.name }}
                                </p>
                                <p class="text-green-600 text-xs">{{ user_info.email }}</p>
                            </div>
                            <button onclick="logout()" class="text-green-700 hover:text-green-900 text-sm">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>
                    {% else %}
                        <div class="bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4 flex items-center">
                            <div class="w-6 h-6 bg-amber-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-exclamation text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-amber-800 text-sm font-medium">
                                    Authentication required
                                </p>
                                <p class="text-amber-600 text-xs">Please login to create presentations</p>
                            </div>
                            <button onclick="login()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-md text-sm transition-colors">
                                <i class="fab fa-google mr-1"></i>
                                Login
                            </button>
                        </div>
                    {% endif %}
                    
                    <form id="presentation-form">
                        <!-- Creative Concept -->
                        <div class="mb-4">
                            <label for="concept" class="block text-sm font-medium text-gray-700 mb-2">
                                Creative Concept
                            </label>
                            <textarea 
                                id="concept" 
                                name="concept" 
                                required
                                class="concept-textarea w-full px-3 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                placeholder="Describe your presentation idea, product launch, marketing campaign, etc..."
                            ></textarea>
                        </div>

                        <!-- Title -->
                        <div class="mb-6">
                            <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
                                Presentation Title
                            </label>
                            <input 
                                type="text" 
                                id="title" 
                                name="title" 
                                class="w-full px-3 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                placeholder="My Creative Presentation"
                            >
                        </div>

                        <!-- Generate Button -->
                        <button 
                            type="submit" 
                            id="generate-btn"
                            class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg font-medium transition-colors"
                        >
                            <i class="fas fa-rocket mr-2"></i>
                            Generate Presentation
                        </button>
                    </form>
                </div>
            </div>

            <!-- Right Sidebar -->
            <div class="space-y-6">
                <!-- Status Card -->
                <div class="tool-card p-6">
                    <div class="flex items-center mb-4">
                        <div class="icon-circle bg-gradient-to-r from-green-500 to-teal-500 mr-3">
                            <i class="fas fa-chart-line text-sm"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900">Status</h3>
                    </div>
                    
                    <div id="status-output">
                        <div class="bg-gray-50 rounded-lg p-4 text-gray-600 text-sm">
                            Ready to generate presentation...
                        </div>
                    </div>
                </div>

                <!-- Result Card -->
                <div class="tool-card p-6">
                    <div class="flex items-center mb-4">
                        <div class="icon-circle bg-gradient-to-r from-blue-500 to-purple-500 mr-3">
                            <i class="fas fa-external-link-alt text-sm"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900">Result</h3>
                    </div>
                    
                    <div id="url-output">
                        <div class="bg-gray-50 rounded-lg p-4 text-gray-600 text-sm">
                            URL will appear here after generation...
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        function login() {
            window.location.href = '/login';
        }

        function logout() {
            window.location.href = '/logout';
        }

        document.getElementById('presentation-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const generateBtn = document.getElementById('generate-btn');
            const statusOutput = document.getElementById('status-output');
            const urlOutput = document.getElementById('url-output');
            
            // Check if user is authenticated
            {% if not user_info %}
                statusOutput.innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4 text-red-800 text-sm">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Please authenticate with Google first
                    </div>
                `;
                return;
            {% endif %}
            
            // Get form data
            const formData = new FormData(e.target);
            const data = {
                concept: formData.get('concept'),
                title: formData.get('title')
            };
            
            // Update UI
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Generating...';
            
            statusOutput.innerHTML = `
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-blue-800 text-sm">
                    <i class="fas fa-hourglass-half mr-2"></i>
                    Generating presentation... This may take a few minutes.
                </div>
            `;
            
            try {
                const response = await fetch('/api/create-presentation', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    statusOutput.innerHTML = `
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-green-800 text-sm">
                            <i class="fas fa-check-circle mr-2"></i>
                            ${result.message}
                        </div>
                    `;
                    
                    urlOutput.innerHTML = `
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <a href="${result.url}" target="_blank" class="text-blue-600 hover:text-blue-800 break-all text-sm">
                                <i class="fas fa-external-link-alt mr-2"></i>
                                ${result.url}
                            </a>
                        </div>
                    `;
                } else {
                    throw new Error(result.error || 'Unknown error occurred');
                }
                
            } catch (error) {
                statusOutput.innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4 text-red-800 text-sm">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Error: ${error.message}
                    </div>
                `;
                
                urlOutput.innerHTML = `
                    <div class="bg-gray-50 rounded-lg p-4 text-gray-600 text-sm">
                        URL will appear here after generation...
                    </div>
                `;
            } finally {
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fas fa-rocket mr-2"></i>Generate Presentation';
            }
        });
    </script>
</body>
</html>